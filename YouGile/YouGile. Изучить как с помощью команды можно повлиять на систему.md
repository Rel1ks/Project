 #automation #powershell #cmd #registry #system-administration #Yougile #Проект #артефакт

## Основные способы воздействия на систему

### 1. **Командная строка (`cmd.exe`)**
- Подходит для базовой автоматизации.
- Работает с файлами, службами, реестром, сетью.
- Использует `.bat` / `.cmd` скрипты.

#### Примеры:
```cmd
:: Удалить папку рекурсивно
rmdir /s /q C:\temp\junk

:: Отключить службу печати
net stop Spooler

:: Изменить параметр реестра
reg add "HKCU\Software\Microsoft\Windows\CurrentVersion\Explorer\Advanced" /v Hidden /t REG_DWORD /d 1 /f
```

---

### 2. **PowerShell**
- Самый мощный встроенный инструмент администрирования.
- Полный доступ к .NET, WMI, CIM, реестру, политикам.
- Поддерживает сложную логику, функции, модули.
- Скрипты: `.ps1`

#### Примеры:
```powershell
# Создать пользователя
New-LocalUser -Name "TestUser" -Password (ConvertTo-SecureString "P@ssw0rd!" -AsPlainText -Force)

# Отключить UAC
Set-ItemProperty -Path "HKLM:\SOFTWARE\Microsoft\Windows\CurrentVersion\Policies\System" -Name "EnableLUA" -Value 0

# Перезагрузить ПК немедленно
Restart-Computer -Force
```

> ⚠️ По умолчанию выполнение `.ps1`-скриптов заблокировано.  
> Разрешить:  
> ```powershell
> Set-ExecutionPolicy RemoteSigned -Scope CurrentUser
> ```

---

### 3. **Редактор реестра (`regedit` / `reg`)**
- Реестр — ядро конфигурации Windows.
- Через него можно:
  - Менять поведение Проводника
  - Отключать компоненты (например, обновления)
  - Настраивать безопасность и интерфейс

#### Команды:
```cmd
REM Выводит список всех служб и драйверов, зарегистрированных в системе.
reg query "HKLM\SYSTEM\CurrentControlSet\Services"

REM Полностью удаляет раздел реестра MyApp(настройки приложений) из настроек текущего пользователя.
reg delete "HKCU\Software\MyApp" /f
```

---

### 4. **Специализированные системные утилиты**

| Утилита        | Назначение                                  |
| -------------- | ------------------------------------------- |
| `netsh`        | Настройка сети и брандмауэра                |
| `schtasks`     | Планировщик задач (запуск по расписанию)    |
| `gpupdate`     | Принудительное применение групповых политик |
| `sfc /scannow` | Проверка целостности системных файлов       |
| `DISM`         | Восстановление образа Windows               |

#### Примеры:
```cmd
:: Сбросить сетевой стек
netsh int ip reset
netsh winsock reset

:: Запланировать перезагрузку
schtasks /create /tn "RebootAtNight" /tr "shutdown /r /f /t 0" /sc daily /st 02:00
```

---

### 5. **Скрипты**

#### Пакетные файлы (`.bat`, `.cmd`)
- Простые, совместимые со всеми версиями Windows.
- Подходят для последовательных действий.

```bat
@echo off
echo Очистка временных файлов...
del /q %TEMP%\*
echo Готово!
pause
```

#### PowerShell-скрипты (`.ps1`)
- Гибкие, безопасные, мощные.
---

### 6. **Права и безопасность**

- Большинство системных изменений требуют **административных прав**.
- UAC (Контроль учётных записей) может блокировать изменения без подтверждения.
- Всегда запускайте терминал **от имени администратора**, если планируете менять систему.

---

## Что можно изменить?

С помощью команд и скриптов вы можете управлять:

- **Пользователями и группами**
- **Безопасностью и политиками**
- **Сетевыми настройками и брандмауэром**
- **Службами и автозагрузкой**
- **Файловой системой и правами доступа**
- **Интерфейсом и поведением ОС**
- **Обновлениями и восстановлением**
